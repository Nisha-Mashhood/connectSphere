{"version":3,"file":"node-cron.utils.js","sourceRoot":"","sources":["../../src/utils/node-cron.utils.ts"],"names":[],"mappings":"AAAA,OAAO,IAAI,MAAM,WAAW,CAAC;AAC7B,OAAO,KAAK,iBAAiB,MAAM,sCAAsC,CAAC;AAE1E,MAAM,CAAC,MAAM,gBAAgB,GAAG,GAAG,EAAE;IACnC,yEAAyE;IACzE,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,KAAK,IAAI,EAAE;QACpC,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAC;QAC3D,IAAI,CAAC;YACH,iCAAiC;YACjC,MAAM,cAAc,GAAG,IAAI,IAAI,EAAE,CAAC;YAClC,cAAc,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC;YAEtD,oCAAoC;YACpC,MAAM,oBAAoB,GAAG,MAAM,iBAAiB,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC;YAC5F,OAAO,CAAC,GAAG,CAAC,oBAAoB,oBAAoB,6BAA6B,CAAC,CAAC;YAEnF,qCAAqC;YACrC,MAAM,qBAAqB,GAAG,MAAM,iBAAiB,CAAC,uBAAuB,CAAC,cAAc,CAAC,CAAC;YAC9F,OAAO,CAAC,GAAG,CAAC,oBAAoB,qBAAqB,8BAA8B,CAAC,CAAC;YAErF,OAAO,CAAC,GAAG,CAAC,2CAA2C,CAAC,CAAC;QAC3D,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,OAAO,CAAC,GAAG,CAAC,8BAA8B,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;QAC7D,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;AAChD,CAAC,CAAA","sourcesContent":["import cron from \"node-cron\";\r\nimport * as CleanupRepository from \"../repositories/cleanUp.repositry.js\";\r\n\r\nexport const scheduleNodeCorn = () => {\r\n  // Cleanup old GroupRequest and MentorRequest documents daily at midnight\r\n  cron.schedule(\"0 0 * * *\", async () => {\r\n    console.log(\"Running daily cleanup task for old requests\");\r\n    try {\r\n      // Calculate the date 15 days ago\r\n      const fifteenDaysAgo = new Date();\r\n      fifteenDaysAgo.setDate(fifteenDaysAgo.getDate() - 15);\r\n\r\n      // Delete old GroupRequest documents\r\n      const deletedGroupRequests = await CleanupRepository.deleteOldGroupRequests(fifteenDaysAgo);\r\n      console.log(`Cleanup: Deleted ${deletedGroupRequests} old GroupRequest documents`);\r\n\r\n      // Delete old MentorRequest documents\r\n      const deletedMentorRequests = await CleanupRepository.deleteOldMentorRequests(fifteenDaysAgo);\r\n      console.log(`Cleanup: Deleted ${deletedMentorRequests} old MentorRequest documents`);\r\n\r\n      console.log(\"Daily cleanup task completed successfully\");\r\n    } catch (error: any) {\r\n      console.log(`Daily cleanup task failed: ${error.message}`);\r\n    }\r\n  });\r\n\r\n  console.log(\"âœ… Node-cron scheduler started.\");\r\n}"]}