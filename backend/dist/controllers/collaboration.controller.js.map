{"version":3,"file":"collaboration.controller.js","sourceRoot":"","sources":["../../src/controllers/collaboration.controller.ts"],"names":[],"mappings":"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","sourcesContent":["import { Request, Response } from \"express\";\r\nimport {\r\n  acceptRequest,\r\n  fetchCollabById,\r\n  fetchRequsetById,\r\n  getCollabDataForMentorService,\r\n  getCollabDataForUserService,\r\n  getCollabsService,\r\n  getMentorRequests,\r\n  getMentorRequestsService,\r\n  getRequsetForUser,\r\n  markUnavailableDaysService,\r\n  processPaymentService,\r\n  processTimeSlotRequest,\r\n  rejectRequest,\r\n  removecollab,\r\n  TemporaryRequestService,\r\n  updateTemporarySlotChangesService,\r\n} from \"../services/collaboration.service.js\";\r\nimport mentorRequset from \"../models/mentorRequset.js\";\r\n\r\nexport const TemporaryRequestController = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  try {\r\n    const { mentorId, userId, selectedSlot, price, timePeriod } = req.body;\r\n\r\n    if (!mentorId || !userId || !selectedSlot || !price || !timePeriod) {\r\n      res.status(400).json({ message: \"All fields are required\" });\r\n      return;\r\n    }\r\n\r\n    const requestData = {\r\n      mentorId,\r\n      userId,\r\n      selectedSlot,\r\n      price,\r\n      timePeriod,\r\n    };\r\n    const newRequest = await TemporaryRequestService(requestData);\r\n\r\n    console.log(newRequest);\r\n\r\n    res.status(201).json({\r\n      message: \"Request created successfully\",\r\n      request: newRequest,\r\n    });\r\n    return;\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n    return;\r\n  }\r\n};\r\n\r\n// Get all mentor requests for the logged-in mentor\r\nexport const getMentorRequestsController = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  const mentorId = req.query.mentorId as string;\r\n  if (!mentorId) {\r\n    res.status(400).json({ message: \"Mentor ID is required.\" });\r\n    return;\r\n  }\r\n  try {\r\n    const mentorRequests = await getMentorRequests(mentorId);\r\n    res.status(200).json({ requests: mentorRequests });\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// Accept a mentor request\r\nexport const acceptRequestController = async (req: Request, res: Response) => {\r\n  try {\r\n    const { id } = req.params;\r\n    const request = await acceptRequest(id);\r\n    res.status(200).json({ message: \"Request accepted\", request });\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// Reject a mentor request\r\nexport const rejectRequestController = async (req: Request, res: Response) => {\r\n  try {\r\n    const { id } = req.params;\r\n    const request = await rejectRequest(id);\r\n    res.status(200).json({ message: \"Request rejected\", request });\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// Get requset for user\r\nexport const getRequsetForUserController = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  try {\r\n    const { id } = req.params;\r\n    const userRequest = await getRequsetForUser(id);\r\n    res\r\n      .status(200)\r\n      .json({\r\n        message: \"Request retrieved successfully\",\r\n        requests: userRequest,\r\n      });\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n//Make payemnt requset\r\nexport const makeStripePaymentController = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  const { paymentMethodId, amount, requestId, email, returnUrl } = req.body;\r\n\r\n  try {\r\n    // Validate returnUrl\r\n    if (!returnUrl) {\r\n      res.status(400).json({\r\n        status: \"failure\",\r\n        error: \"A return URL is required for processing the payment\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Retrieve the mentor request document\r\n    const mentorRequestData = await mentorRequset.findById(requestId);\r\n\r\n    if (!mentorRequestData) {\r\n      res\r\n        .status(404)\r\n        .json({ status: \"failure\", message: \"Mentor request not found\" });\r\n      return;\r\n    }\r\n\r\n    // Process payment and handle collaboration creation\r\n    const paymentResult = await processPaymentService(\r\n      paymentMethodId,\r\n      amount,\r\n      requestId,\r\n      mentorRequestData,\r\n      email,\r\n      returnUrl\r\n    );\r\n\r\n    // Handle different payment intent statuses\r\n    const paymentIntent = \"paymentIntent\" in paymentResult ? paymentResult.paymentIntent : paymentResult;\r\n\r\n    if (paymentIntent.status === \"requires_action\" && paymentIntent.next_action) {\r\n      console.log(paymentIntent.status);\r\n      // Payment requires additional action (like 3D Secure)\r\n      res.status(200).json({\r\n        status: \"requires_action\",\r\n        charge: paymentIntent,\r\n      });\r\n      return;\r\n    } else if (paymentIntent.status === \"succeeded\") {\r\n      // Payment succeeded\r\n      res.status(200).json({\r\n        status: \"success\",\r\n        charge: paymentIntent,\r\n        contacts: \"contacts\" in paymentResult ? paymentResult.contacts : undefined, // Include contacts if present\r\n      });\r\n      return;\r\n    } else {\r\n      // Payment failed or is pending\r\n      res.status(200).json({\r\n        status: \"pending\",\r\n        charge: paymentIntent,\r\n        message: `Payment status: ${paymentIntent.status}`,\r\n      });\r\n      return;\r\n    }\r\n  } catch (error: any) {\r\n    console.error(\"Payment error:\", error.message);\r\n    res.status(500).json({ status: \"failure\", error: error.message });\r\n    return;\r\n  }\r\n};\r\n\r\n//get collab data for user\r\nexport const getCollabDataForUserController = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  try {\r\n    const userId = req.params.id;\r\n    const collabData = await getCollabDataForUserService(userId);\r\n    res.status(200).json({ collabData });\r\n    return;\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n    return;\r\n  }\r\n};\r\n\r\n//Get collab data for mentor\r\nexport const getCollabDataForMentorController = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  try {\r\n    const mentorId = req.params.id;\r\n    const collabData = await getCollabDataForMentorService(mentorId);\r\n    res.status(200).json({ collabData });\r\n    return;\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n    return;\r\n  }\r\n};\r\n\r\n//delete collab\r\nexport const deleteCollab = async (req: Request, res: Response) => {\r\n  const { collabId } = req.params;\r\n  const { reason } = req.body;\r\n\r\n  try {\r\n    const response = await removecollab(collabId, reason);\r\n    res.status(200).json({\r\n      status: \"success\",\r\n      message: \"Collab deleted successfully\",\r\n      response,\r\n    });\r\n  } catch (error: any) {\r\n    console.error(\"Error:\", error.message);\r\n    res.status(500).json({ status: \"failure\", error: error.message });\r\n  }\r\n};\r\n\r\n//FOR ADMIN\r\n\r\n// Get all mentor requests\r\nexport const getAllMentorRequests = async (req: Request, res: Response) => {\r\n  try {\r\n    const { page = 1, limit = 10, search = '' } = req.query;\r\n    const mentorRequests = await getMentorRequestsService({\r\n      page: Number(page),\r\n      limit: Number(limit),\r\n      search: String(search)\r\n    });\r\n    res.status(200).json(mentorRequests);\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\nexport const getAllCollabs = async (req: Request, res: Response) => {\r\n  try {\r\n    const { page = 1, limit = 10, search = '' } = req.query;\r\n    const collaborations = await getCollabsService({\r\n      page: Number(page),\r\n      limit: Number(limit),\r\n      search: String(search)\r\n    });\r\n    res.status(200).json(collaborations);\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n//get collab details by collabId\r\nexport const getCollabDeatilsbyCollabId = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  const { collabId } = req.params;\r\n  try {\r\n    const collabDetails = await fetchCollabById(collabId);\r\n    res\r\n      .status(200)\r\n      .json({ message: \"Collab details accessed successfully\", data: collabDetails });\r\n    return;\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n    return;\r\n  }\r\n};\r\n\r\n//get Requset deatils using requsetId\r\nexport const getRequestDeatilsbyRequestId = async (\r\n  req: Request,\r\n  res: Response\r\n) => {\r\n  const { requestId } = req.params;\r\n  try {\r\n    const requestDetails = await fetchRequsetById(requestId);\r\n    res\r\n      .status(200)\r\n      .json({ message: \"Requset details accessed successfully\", data: requestDetails });\r\n    return;\r\n  } catch (error: any) {\r\n    res.status(500).json({ message: error.message });\r\n    return;\r\n  }\r\n};\r\n\r\n\r\n// Mark Dates as Unavailable\r\nexport const markUnavailableDays = async (req: Request, res: Response) => {\r\n  const { collabId } = req.params;\r\n  const { datesAndReasons, requestedBy, requesterId, approvedById, isApproved } =\r\n    req.body;\r\n\r\n  try {\r\n    const updatedCollaboration = await markUnavailableDaysService(collabId, {\r\n      datesAndReasons,\r\n      requestedBy,\r\n      requesterId,\r\n      approvedById,\r\n      isApproved,\r\n    });\r\n\r\n    console.log(\"collaboration collection updated\");\r\n    res\r\n      .status(200)\r\n      .json({ message: \"Unavailable days updated\", data: updatedCollaboration });\r\n      return \r\n  } catch (error:any) {\r\n    res.status(500).json({ message: error.message });\r\n    return\r\n  }\r\n};\r\n\r\n// Update Time Slots\r\nexport const updateTemporarySlotChanges = async (req: Request, res: Response) => {\r\n  const { collabId } = req.params;\r\n  const { datesAndNewSlots, requestedBy, requesterId, approvedById, isApproved } =\r\n    req.body;\r\n\r\n  try {\r\n    const updatedCollaboration = await updateTemporarySlotChangesService(collabId, {\r\n      datesAndNewSlots,\r\n      requestedBy,\r\n      requesterId,\r\n      approvedById,\r\n      isApproved,\r\n    });\r\n\r\n    res\r\n      .status(200)\r\n      .json({ message: \"Temporary slot changes updated\", data: updatedCollaboration });\r\n      return \r\n  } catch (error:any) {\r\n    res.status(500).json({ message: error.message });\r\n    return\r\n  }\r\n};\r\n\r\nexport const approveTimeSlotRequest = async (req: Request, res: Response) => {\r\n  const { collabId } = req.params;\r\n  const { requestId, isApproved, requestType } = req.body;\r\n\r\n  try {\r\n    console.log(\"Processing time slot request for collabId:\", collabId);\r\n    console.log(\"Request Body:\", req.body);\r\n    console.log(\"requestId:\", requestId);\r\n    console.log(\"isApproved:\", isApproved);\r\n    console.log(\"requestType:\", requestType);\r\n\r\n    const updatedCollaboration = await processTimeSlotRequest(\r\n      collabId,\r\n      requestId,\r\n      isApproved,\r\n      requestType as \"unavailable\" | \"timeSlot\",\r\n    );\r\n\r\n    res.status(200).json({\r\n      message: \"Time slot request processed successfully\",\r\n      data: updatedCollaboration,\r\n    });\r\n  } catch (error: any) {\r\n    console.error(\"Error processing time slot request:\", error);\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};"]}