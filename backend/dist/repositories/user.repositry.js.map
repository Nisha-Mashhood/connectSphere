{"version":3,"file":"user.repositry.js","sourceRoot":"","sources":["../../src/repositories/user.repositry.ts"],"names":[],"mappings":"AAAA,OAAO,IAAuB,MAAM,yBAAyB,CAAC;AAE9D,oBAAoB;AACpB,MAAM,CAAC,MAAM,UAAU,GAAG,KAAK,EAAE,QAAgC,EAAE,EAAE;IACnE,OAAO,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AACrC,CAAC,CAAC;AAEF,uBAAuB;AACvB,MAAM,CAAC,MAAM,eAAe,GAAG,KAAK,EAAE,KAAa,EAAE,EAAE;IACrD,OAAO,MAAM,IAAI,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;AACvC,CAAC,CAAC;AAEF,oBAAoB;AACpB,MAAM,CAAC,MAAM,YAAY,GAAG,KAAK,EAAE,EAAU,EAAE,EAAE;IAC/C,OAAO,MAAM,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;AACjC,CAAC,CAAC;AAEF,yCAAyC;AACzC,MAAM,CAAC,MAAM,gBAAgB,GAAG,KAAK,EAAE,OAAY,EAAE,QAAgB,EAA0B,EAAE;IAC/F,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;QACnB,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;IAChE,CAAC;IACD,MAAM,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;IACtC,IAAI,IAAI,GAAG,MAAM,eAAe,CAAC,KAAK,CAAC,CAAC;IACxC,IAAI,CAAC,IAAI,EAAE,CAAC;QACV,4CAA4C;QAC5C,IAAI,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC;YACvB,QAAQ,EAAE,OAAO,CAAC,WAAW;YAC7B,KAAK;YACL,QAAQ;YACR,UAAU,EAAE,OAAO,CAAC,EAAE;YACtB,UAAU,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI;YAC3D,IAAI,EAAE,MAAM;SACb,CAAC,CAAC;IACL,CAAC;IACD,OAAO,IAAI,CAAC;AACd,CAAC,CAAC;AAEF,gBAAgB;AAChB,MAAM,CAAC,MAAM,UAAU,GAAG,KAAK,EAC7B,EAAU,EACV,UAAkC,EAClC,EAAE;IACF,OAAO,MAAM,IAAI,CAAC,iBAAiB,CAAC,EAAE,EAAE,UAAU,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;AACrE,CAAC,CAAC;AAEF,iBAAiB;AACjB,MAAM,CAAC,MAAM,cAAc,GAAG,KAAK,EAAE,EAAU,EAAE,QAAgB,EAAE,EAAE,CACnE,IAAI,CAAC,iBAAiB,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;AAE1D,sCAAsC;AACtC,MAAM,CAAC,MAAM,kBAAkB,GAAG,KAAK,EAAE,MAAc,EAAE,YAAoB,EAAE,EAAE;IAC/E,OAAO,MAAM,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,EAAE,YAAY,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;AAC/E,CAAC,CAAC;AAEF,gCAAgC;AAChC,MAAM,CAAC,MAAM,kBAAkB,GAAG,KAAK,EAAE,MAAc,EAAE,EAAE;IACzD,OAAO,MAAM,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;AACrF,CAAC,CAAC","sourcesContent":["import User, { UserInterface } from \"../models/user.model.js\";\r\n\r\n// Create a new user\r\nexport const createUser = async (userData: Partial<UserInterface>) => {\r\n  return await User.create(userData);\r\n};\r\n\r\n// Find a user by email\r\nexport const findUserByEmail = async (email: string) => {\r\n  return await User.findOne({ email });\r\n};\r\n\r\n// Find a user by ID\r\nexport const findUserById = async (id: string) => {\r\n  return await User.findById(id);\r\n};\r\n\r\n// Find or create a user by OAuth profile\r\nexport const findOrCreateUser = async (profile: any, provider: string): Promise<UserInterface> => {\r\n  if (!profile.email) {\r\n    throw new Error(\"Email is required to find or create a user\");\r\n  }\r\n  const email = profile.emails[0].value;\r\n  let user = await findUserByEmail(email);\r\n  if (!user) {\r\n    // If user does not exist, create a new user\r\n    user = await User.create({\r\n      fullName: profile.displayName,\r\n      email,\r\n      provider,\r\n      providerId: profile.id,\r\n      profilePic: profile.photos ? profile.photos[0].value : null,\r\n      role: \"user\",\r\n    });\r\n  }\r\n  return user;\r\n};\r\n\r\n// Update a user\r\nexport const updateUser = async (\r\n  id: string,\r\n  updateData: Partial<UserInterface>\r\n) => {\r\n  return await User.findByIdAndUpdate(id, updateData, { new: true });\r\n};\r\n\r\n//update password\r\nexport const updatePassword = async (id: string, password: string) =>\r\n  User.findByIdAndUpdate(id, { password }, { new: true });\r\n\r\n// Update the refresh token for a user\r\nexport const updateRefreshToken = async (userId: string, refreshToken: string) => {\r\n  return await User.findByIdAndUpdate(userId, { refreshToken }, { new: true });\r\n};\r\n\r\n// Remove refresh token (logout)\r\nexport const removeRefreshToken = async (userId: string) => {\r\n  return await User.findByIdAndUpdate(userId, { refreshToken: null }, { new: true });\r\n};\r\n"]}