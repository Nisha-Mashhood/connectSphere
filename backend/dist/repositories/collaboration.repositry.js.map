{"version":3,"file":"collaboration.repositry.js","sourceRoot":"","sources":["../../src/repositories/collaboration.repositry.ts"],"names":[],"mappings":"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","sourcesContent":["import MentorRequest from \"../models/mentorRequset.js\";\r\nimport Collaboration, { ICollaboration } from \"../models/collaboration.js\";\r\n\r\n//create a temporary requset document\r\nexport const createTemporaryRequest = async (data: any) => {\r\n    try {\r\n      const request = new MentorRequest(data);\r\n      return await request.save();\r\n    } catch (error:any) {\r\n      throw new Error(`Error saving temporary request: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // Get mentor requests from the database\r\nexport const getMentorRequestsByMentorId = async (mentorId: string) => {\r\n  try {\r\n    return await MentorRequest.find({ mentorId })\r\n      .populate(\"userId\", \"name profilePic\") \r\n  } catch (error: any) {\r\n    throw new Error(`Error fetching mentor requests: ${error.message}`);\r\n  }\r\n};\r\n\r\n// Find mentor request by ID\r\nexport const findMentorRequestById = async (id: string) => {\r\n  try {\r\n    return await MentorRequest.findById(id);\r\n  } catch (error: any) {\r\n    throw new Error(`Error fetching mentor request by ID: ${error.message}`);\r\n  }\r\n};\r\n\r\n// Update mentor request acceptance status\r\nexport const updateMentorRequestStatus = async (id: string, status: string) => {\r\n  try {\r\n    const request = await MentorRequest.findById(id);\r\n    if (request) {\r\n      request.isAccepted = status;\r\n      await request.save();\r\n      return request;\r\n    }\r\n    throw new Error(\"Request not found\");\r\n  } catch (error: any) {\r\n    throw new Error(`Error updating mentor request status: ${error.message}`);\r\n  }\r\n};\r\n\r\nexport const getRequestByUserId = async (userId: string) => {\r\n  return await MentorRequest.find({ userId })\r\n    .populate({\r\n      path: 'mentorId',  \r\n      populate: {\r\n        path: 'userId',\r\n        select: 'name email profilePic'\r\n      }\r\n    })\r\n};\r\n\r\nexport const createCollaboration = async (collaborationData: Partial<ICollaboration>): Promise<ICollaboration> => {\r\n  const collaborationResult = new Collaboration(collaborationData);\r\n  return await collaborationResult.save();\r\n};\r\n\r\n\r\nexport const deleteMentorRequest = async (requestId: string): Promise<void> => {\r\n  await MentorRequest.findByIdAndDelete(requestId);\r\n};\r\n\r\nexport const findCollabById = async(collabId:string): Promise<ICollaboration | null> =>{\r\n  try {\r\n  return await Collaboration.findById(collabId)\r\n  .populate({\r\n    path: \"mentorId\",\r\n    populate: {\r\n      path: \"userId\", \r\n      model: \"User\",\r\n    },\r\n  })\r\n  .populate(\"userId\")as ICollaboration | null;; \r\n  } catch (error:any) {\r\n    throw new Error(\"Error fetching group requests: \" + error.message);\r\n  }\r\n}\r\n\r\nexport const deleteCollabById = async(collabId:string) =>{\r\n  try {\r\n    return await Collaboration.findByIdAndDelete(collabId)\r\n  } catch (error:any) {\r\n    throw new Error(\"Error fetching group requests: \" + error.message);\r\n  }\r\n}\r\n\r\n//mark collaboration as cancelled\r\nexport const markCollabAsCancelled = async (collabId: string) => {\r\n  try {\r\n    return await Collaboration.findByIdAndUpdate(\r\n      collabId,\r\n      { isCancelled: true },\r\n      { new: true } \r\n    );\r\n  } catch (error: any) {\r\n    throw new Error(\"Error updating collaboration: \" + error.message);\r\n  }\r\n};\r\n\r\n//update feedback given filed of the collaboartion\r\nexport const updateCollabFeedback = async (collabId: string) => {\r\n  try {\r\n    return await Collaboration.findByIdAndUpdate(\r\n      collabId,\r\n      { feedbackGiven: true }, \r\n      { new: true }\r\n    );\r\n  } catch (error: any) {\r\n    throw new Error(`Error updating collaboration feedback status: ${error.message}`);\r\n  }\r\n};\r\n\r\n//Get collab data For user\r\nexport const getCollabDataForUser = async (userId: string) => {\r\n  try {\r\n    const collabData = await Collaboration.find({ userId, isCancelled:false })\r\n    .populate({\r\n      path: 'mentorId',  \r\n      populate: {\r\n        path: 'userId',\r\n        select: 'name email profilePic'\r\n      }\r\n    })\r\n    .populate('userId');\r\n    return collabData;\r\n  } catch (error:any) {\r\n    throw new Error(`Error getting collaboration data for user: ${error.message}`);\r\n  }\r\n};\r\n\r\n//get collab data for mentor\r\nexport const getCollabDataForMentor = async (mentorId: string) => {\r\n  try {\r\n    const collabData = await Collaboration.find({ mentorId, isCancelled:false })\r\n    .populate('mentorId')\r\n    .populate(\"userId\", \"name email profilePic\") \r\n    return collabData;\r\n  } catch (error:any) {\r\n    throw new Error(`Error getting collaboration data for mentor: ${error.message}`);\r\n  }\r\n};\r\n\r\n//FOR ADMIN\r\n\r\n//Get All Requsets\r\nexport const findMentorRequest = async () => {\r\n  try {\r\n    return await MentorRequest.find()\r\n    .populate({\r\n      path: \"mentorId\",\r\n      model: \"Mentor\",\r\n      populate: {\r\n        path: \"userId\",\r\n        model: \"User\",\r\n      },\r\n    })\r\n    .populate({\r\n      path: \"userId\",\r\n      model: \"User\",\r\n    }) ;\r\n  } catch (error: any) {\r\n    throw new Error(`Error fetching mentor request : ${error.message}`);\r\n  }\r\n};\r\n\r\n//Get All Collab\r\nexport const findCollab = async (): Promise<ICollaboration[] | null> => {\r\n  try {\r\n    return await Collaboration.find()\r\n      .populate({\r\n        path: \"mentorId\",\r\n        model: \"Mentor\",\r\n        populate: {\r\n          path: \"userId\",\r\n          model: \"User\",\r\n        },\r\n      })\r\n      .populate({\r\n        path: \"userId\",\r\n        model: \"User\",\r\n      }) as ICollaboration[] | null;\r\n  } catch (error: any) {\r\n    throw new Error(\"Error fetching collaborations: \" + error.message);\r\n  }\r\n};\r\n\r\n//get requset details\r\nexport const fetchMentorRequsetDetails = async(requsetId: string) =>{\r\n    try {\r\n      return await MentorRequest.findById(requsetId)\r\n      .populate({\r\n        path: \"mentorId\",\r\n        model: \"Mentor\",\r\n        populate: {\r\n          path: \"userId\",\r\n          model: \"User\",\r\n        },\r\n      })\r\n      .populate({\r\n        path: \"userId\",\r\n        model: \"User\",\r\n      }) ;\r\n  } catch (error:any) {\r\n    throw new Error(`Error fetching mentor request : ${error.message}`);\r\n  }\r\n}\r\n\r\n//get collab details\r\nexport const findCollabDetails = async (collabId: string): Promise<ICollaboration[] | null> => {\r\n  try {\r\n    return await Collaboration.findById(collabId)\r\n      .populate({\r\n        path: \"mentorId\",\r\n        model: \"Mentor\",\r\n        populate: {\r\n          path: \"userId\",\r\n          model: \"User\",\r\n        },\r\n      })\r\n      .populate({\r\n        path: \"userId\",\r\n        model: \"User\",\r\n      }) as ICollaboration[] | null;\r\n  } catch (error: any) {\r\n    throw new Error(\"Error fetching collaboration Details: \" + error.message);\r\n  }\r\n};"]}