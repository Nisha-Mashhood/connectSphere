{"version":3,"file":"notification.modal.js","sourceRoot":"","sources":["../../src/models/notification.modal.ts"],"names":[],"mappings":"AAAA,OAAO,QAAQ,MAAM,UAAU,CAAC;AAEhC,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,UAAU,CAAC;AACzC,OAAO,EAAE,gBAAgB,EAAE,MAAM,+BAA+B,CAAC;AAsBjE,MAAM,qBAAqB,GAAG,IAAI,MAAM,CAAkB;IACxD,iBAAiB,EAAC;QAChB,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE,IAAI;KACb;IACD,MAAM,EAAE;QACN,IAAI,EAAE,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QACpC,GAAG,EAAE,MAAM;QACX,QAAQ,EAAE,IAAI;QACd,KAAK,EAAE,IAAI;KACZ;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,IAAI,EAAE,CAAC,SAAS,EAAE,eAAe,EAAE,aAAa,EAAE,eAAe,CAAC;QAClE,QAAQ,EAAE,IAAI;KACf;IACD,OAAO,EAAE;QACP,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACf;IACD,SAAS,EAAE;QACT,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACf;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QACpC,GAAG,EAAE,MAAM;QACX,QAAQ,EAAE,IAAI;KACf;IACD,MAAM,EAAE;QACN,IAAI,EAAE,MAAM;QACZ,IAAI,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC;QACxB,OAAO,EAAE,QAAQ;KAClB;IACD,MAAM,EAAE;QACN,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAChB,EAAE,8BAA8B;IACjC,gBAAgB,EAAE;QAChB,IAAI,EAAE,IAAI;QACV,QAAQ,EAAE,KAAK;KAChB;IACD,gBAAgB,EAAE;QAChB,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAChB;IACD,SAAS,EAAE;QACT,IAAI,EAAE,IAAI;QACV,OAAO,EAAE,IAAI,CAAC,GAAG;KAClB;IACD,SAAS,EAAE;QACT,IAAI,EAAE,IAAI;QACV,OAAO,EAAE,IAAI,CAAC,GAAG;KAClB;IACD,WAAW,EAAE;QACX,WAAW,EAAC;YACV,IAAI,EAAC,MAAM;YACX,IAAI,EAAC,CAAC,SAAS,EAAC,OAAO,EAAE,eAAe,EAAE,gBAAgB,CAAC;YAC3D,QAAQ,EAAC,KAAK;SACf;QACD,SAAS,EAAC;YACR,IAAI,EAAC,MAAM;YACX,QAAQ,EAAC,KAAK;SACf;KACF;CACF,CAAC,CAAC;AAEH,qBAAqB,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;AAE1D,8CAA8C;AAC9C,qBAAqB,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,WAAW,IAAI;IACpD,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAC5B,IAAI,CAAC,iBAAiB,GAAG,MAAM,gBAAgB,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC;IAC5E,CAAC;IACD,IAAI,EAAE,CAAC;AACT,CAAC,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,oBAAoB,GAAG,KAAK,CACvC,iBAAiB,EACjB,qBAAqB,CACtB,CAAC","sourcesContent":["import mongoose from \"mongoose\";\r\nimport { ObjectId } from \"mongoose\";\r\nimport { Schema, model } from \"mongoose\";\r\nimport { generateCustomId } from \"../utils/idGenerator.utils.js\";\r\n\r\nexport interface AppNotification {\r\n  _id: string;\r\n  AppNotificationId: string;\r\n  userId: string | ObjectId;\r\n  type: \"message\" | \"incoming_call\" | \"missed_call\" | \"task_reminder\";\r\n  content: string;\r\n  relatedId: string; // chatKey for messages/calls, taskId for tasks\r\n  senderId: string | ObjectId;\r\n  status: \"unread\" | \"read\";\r\n  callId?: string;\r\n  notificationDate?: Date;\r\n  notificationTime?: string;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n  taskContext?: {\r\n    contextType: \"profile\" | \"group\" | \"collaboration\" | \"userconnection\";\r\n    contextId: string;\r\n  };\r\n}\r\n\r\nconst AppNotificationSchema = new Schema<AppNotification>({\r\n  AppNotificationId:{\r\n    type: String,\r\n    unique: true,\r\n  },\r\n  userId: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: \"User\",\r\n    required: true,\r\n    index: true,\r\n  },\r\n  type: {\r\n    type: String,\r\n    enum: [\"message\", \"incoming_call\", \"missed_call\", \"task_reminder\"],\r\n    required: true,\r\n  },\r\n  content: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  relatedId: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  senderId: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: \"User\",\r\n    required: true,\r\n  },\r\n  status: {\r\n    type: String,\r\n    enum: [\"unread\", \"read\"],\r\n    default: \"unread\",\r\n  },\r\n  callId: {\r\n    type: String,\r\n    required: false,\r\n  }, // Unique identifier for calls\r\n  notificationDate: {\r\n    type: Date,\r\n    required: false,\r\n  },\r\n  notificationTime: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  createdAt: {\r\n    type: Date,\r\n    default: Date.now,\r\n  },\r\n  updatedAt: {\r\n    type: Date,\r\n    default: Date.now,\r\n  },\r\n  taskContext: {\r\n    contextType:{\r\n      type:String,\r\n      enum:[\"profile\",\"group\", \"collaboration\", \"userconnection\"],\r\n      required:false,\r\n    },\r\n    contextId:{\r\n      type:String,\r\n      required:false,\r\n    },\r\n  },\r\n});\r\n\r\nAppNotificationSchema.index({ userId: 1, createdAt: -1 });\r\n\r\n// Pre-save hook to generate AppNotificationId\r\nAppNotificationSchema.pre(\"save\", async function (next) {\r\n  if (!this.AppNotificationId) {\r\n    this.AppNotificationId = await generateCustomId(\"appNotification\", \"ANF\");\r\n  }\r\n  next();\r\n});\r\n\r\nexport const AppNotificationModel = model<AppNotification>(\r\n  \"AppNotification\",\r\n  AppNotificationSchema\r\n);\r\n"]}